<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Chanel x Pulp Fiction Experience</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
      #debug {
        position: fixed;
        top: 10px;
        left: 10px;
        background: rgba(0,0,0,0.85);
        color: #0f0;
        padding: 10px;
        font-family: monospace;
        font-size: 11px;
        z-index: 1000;
        max-width: 280px;
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid #0f0;
      }
      #instructions {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.8);
        color: #fff;
        padding: 15px 30px;
        font-family: 'Helvetica Neue', sans-serif;
        font-size: 14px;
        border-radius: 0;
        border: 1px solid #FFD700;
        z-index: 1000;
        text-transform: uppercase;
        letter-spacing: 2px;
      }
      #title {
        position: fixed;
        top: 10px;
        right: 10px;
        color: #FFD700;
        font-family: 'Georgia', serif;
        font-size: 18px;
        font-style: italic;
        z-index: 1000;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
      }
      #controls {
        position: fixed;
        bottom: 70px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.6);
        color: #aaa;
        padding: 8px 15px;
        font-family: monospace;
        font-size: 11px;
        z-index: 1000;
      }
    </style>
  </head>
  <body>
    <div id="debug">Initialisation...</div>
    <div id="controls">ZQSD / ‚Üê‚Üë‚Üì‚Üí : se d√©placer ‚Ä¢ Souris : regarder</div>
    <div id="instructions">Cliquez sur le $5 Shake</div>
    <div id="title">CHANEL √ó Pulp Fiction</div>

    <a-scene>
      
      <a-assets>
        <img id="dancer1" src="https://cdn.pixabay.com/photo/2014/04/03/10/32/dancer-310890_1280.png" crossorigin="anonymous">
        
        <!-- 
        ============================================
        POLY PIZZA - COMMENT AJOUTER DES MOD√àLES 3D
        ============================================
        
        1. Allez sur https://poly.pizza
        2. Cherchez un mod√®le (ex: "briefcase", "milkshake", "booth")
        3. T√©l√©chargez le format GLB (recommand√©) ou GLTF
        4. H√©bergez le fichier (GitHub, votre serveur, etc.)
        5. Ajoutez-le ici dans <a-assets> :
        
        <a-asset-item id="briefcase-model" src="URL_VERS_VOTRE_FICHIER.glb"></a-asset-item>
        <a-asset-item id="milkshake-model" src="URL_VERS_VOTRE_FICHIER.glb"></a-asset-item>
        <a-asset-item id="booth-model" src="URL_VERS_VOTRE_FICHIER.glb"></a-asset-item>
        <a-asset-item id="jukebox-model" src="URL_VERS_VOTRE_FICHIER.glb"></a-asset-item>
        
        6. Puis utilisez-les dans la sc√®ne :
        
        <a-entity gltf-model="#briefcase-model" position="0 0 -1.5" scale="0.5 0.5 0.5"></a-entity>
        
        CONSEIL: Ajustez scale et position selon la taille du mod√®le
        ============================================
        -->
        
      </a-assets>

      <!-- CAM√âRA AVEC D√âPLACEMENT ZQSD/FL√àCHES -->
      <a-entity id="rig" position="0 0 1.5"
                movement-controls="controls: keyboard"
                wasd-controls="acceleration: 20; wsAxis: z; adAxis: x">
        <a-camera id="cam" 
                  position="0 1.6 0"
                  look-controls="enabled: true; pointerLockEnabled: true">
          <a-cursor 
            id="cursor"
            color="#FFD700"
            opacity="0.8"
            raycaster="objects: .clickable; far: 15"
            fuse="false"
            animation__scale="property: scale; from: 1 1 1; to: 1.2 1.2 1.2; dur: 500; dir: alternate; loop: true">
          </a-cursor>
          
          <!-- Black-out pour transition -->
          <a-plane id="black-out" position="0 0 -0.3" width="6" height="6" 
                   material="color: #000; opacity: 0; transparent: true; shader: flat; side: double" 
                   visible="false">
          </a-plane>
        </a-camera>
      </a-entity>

      <!-- Cube principal (salle) - AGRANDI pour exploration -->
      <a-box id="room" position="0 3 0" width="8" height="6" depth="8" 
             material="color: #1a0a0a; metalness: 0.3; roughness: 0.7; side: back">
      </a-box>

      <!-- Sol r√©el pour marcher -->
      <a-plane id="floor" position="0 0 0" rotation="-90 0 0" width="8" height="8"
               material="color: #1a1a1a; metalness: 0.5; roughness: 0.5">
      </a-plane>

      <!-- ========== SC√àNE A : JACK RABBIT SLIM'S ========== -->
      <a-entity id="scene-a">
        
        <!-- DANCEFLOOR DAMIER (agrandi) -->
        <a-entity id="dancefloor" position="0 0.01 -1">
          <!-- G√©n√©ration du damier 6x6 -->
          <!-- Rang√©e 1 -->
          <a-box position="-1.25 0 -1.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.75 0 -1.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.25 0 -1.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.25 0 -1.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.75 0 -1.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="1.25 0 -1.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <!-- Rang√©e 2 -->
          <a-box position="-1.25 0 -0.75" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.75 0 -0.75" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.25 0 -0.75" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.25 0 -0.75" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.75 0 -0.75" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="1.25 0 -0.75" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <!-- Rang√©e 3 -->
          <a-box position="-1.25 0 -0.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.75 0 -0.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.25 0 -0.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.25 0 -0.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.75 0 -0.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="1.25 0 -0.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <!-- Rang√©e 4 -->
          <a-box position="-1.25 0 0.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.75 0 0.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.25 0 0.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.25 0 0.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.75 0 0.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="1.25 0 0.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <!-- Rang√©e 5 -->
          <a-box position="-1.25 0 0.75" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.75 0 0.75" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.25 0 0.75" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.25 0 0.75" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.75 0 0.75" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="1.25 0 0.75" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <!-- Rang√©e 6 -->
          <a-box position="-1.25 0 1.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.75 0 1.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="-0.25 0 1.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.25 0 1.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="0.75 0 1.25" width="0.5" height="0.02" depth="0.5" color="#EEE" material="metalness: 0.8; roughness: 0.2"></a-box>
          <a-box position="1.25 0 1.25" width="0.5" height="0.02" depth="0.5" color="#111" material="metalness: 0.8; roughness: 0.2"></a-box>
        </a-entity>

        <!-- DANSEURS (Vincent & Mia) sur le dancefloor -->
        <a-entity id="dancers" position="0 0 -1">
          <!-- Mia -->
          <a-entity id="mia" position="-0.7 0 0">
            <a-image src="#dancer1" position="0 1 0" width="1" height="1.6" transparent="true" opacity="0.9"
                     animation__twist="property: rotation; from: 0 -15 -4; to: 0 15 4; dur: 700; dir: alternate; loop: true; easing: easeInOutSine">
            </a-image>
          </a-entity>
          
          <!-- Vincent -->
          <a-entity id="vincent" position="0.7 0 0">
            <a-image src="#dancer1" position="0 1 0" width="1" height="1.6" transparent="true" opacity="0.9" scale="-1 1 1"
                     animation__twist="property: rotation; from: 0 15 4; to: 0 -15 -4; dur: 750; dir: alternate; loop: true; easing: easeInOutSine">
            </a-image>
          </a-entity>
        </a-entity>

        <!-- BOOTH ROUGE (c√¥t√© droit) -->
        <a-entity id="booth-right" position="3 0 0" rotation="0 -90 0">
          <a-box position="0 0.4 0" width="2.5" height="0.15" depth="0.7" color="#8B0000" 
                 material="metalness: 0.1; roughness: 0.8"></a-box>
          <a-box position="0 0.9 0.3" width="2.5" height="0.8" depth="0.1" color="#8B0000"
                 material="metalness: 0.1; roughness: 0.8"></a-box>
          <!-- Table -->
          <a-cylinder position="0 0.65 -0.5" radius="0.45" height="0.05" color="#222"
                      material="metalness: 0.9; roughness: 0.1"></a-cylinder>
          <a-cylinder position="0 0.35 -0.5" radius="0.06" height="0.65" color="#888"
                      material="metalness: 0.9; roughness: 0.1"></a-cylinder>
        </a-entity>

        <!-- BOOTH ROUGE (c√¥t√© gauche) -->
        <a-entity id="booth-left" position="-3 0 0" rotation="0 90 0">
          <a-box position="0 0.4 0" width="2.5" height="0.15" depth="0.7" color="#8B0000" 
                 material="metalness: 0.1; roughness: 0.8"></a-box>
          <a-box position="0 0.9 0.3" width="2.5" height="0.8" depth="0.1" color="#8B0000"
                 material="metalness: 0.1; roughness: 0.8"></a-box>
          <!-- Table avec le MILKSHAKE -->
          <a-cylinder position="0 0.65 -0.5" radius="0.45" height="0.05" color="#222"
                      material="metalness: 0.9; roughness: 0.1"></a-cylinder>
          <a-cylinder position="0 0.35 -0.5" radius="0.06" height="0.65" color="#888"
                      material="metalness: 0.9; roughness: 0.1"></a-cylinder>
        </a-entity>

        <!-- MILKSHAKE $5 (sur la table de gauche) -->
        <a-entity id="trigger-milkshake" class="clickable" position="-2.5 0.75 0">
          <!-- Hitbox -->
          <a-box class="clickable" width="0.3" height="0.5" depth="0.3" 
                 material="opacity: 0; transparent: true"></a-box>
          
          <!-- 
          ==========================================
          REMPLACEZ CE BLOC PAR UN MOD√àLE POLY PIZZA:
          <a-entity gltf-model="#milkshake-model" scale="0.3 0.3 0.3"></a-entity>
          ==========================================
          -->
          
          <!-- Verre tulipe (placeholder) -->
          <a-cylinder radius="0.06" height="0.22" position="0 0.05 0" color="#FADADD"
                      material="metalness: 0.2; roughness: 0.3; opacity: 0.9; transparent: true">
          </a-cylinder>
          <a-sphere radius="0.07" position="0 0.18 0" color="#FFF5F5"></a-sphere>
          <a-sphere radius="0.015" position="0 0.25 0" color="#DC143C"
                    material="metalness: 0.3; roughness: 0.5"></a-sphere>
          <a-cylinder radius="0.008" height="0.2" position="0.03 0.2 0" rotation="0 0 10" color="#FF69B4"></a-cylinder>
          
          <a-light type="point" intensity="0.6" distance="1.5" color="#FFB6C1"></a-light>
          
          <a-text value="$5" position="0 0.4 0" align="center" 
                  scale="0.4 0.4 0.4" color="#FFD700" 
                  animation__float="property: position; from: 0 0.4 0; to: 0 0.45 0; dur: 1000; dir: alternate; loop: true">
          </a-text>
        </a-entity>

        <!-- JUKEBOX (fond de salle) -->
        <!-- 
        REMPLACEZ PAR UN MOD√àLE POLY PIZZA:
        <a-entity gltf-model="#jukebox-model" position="0 0 -3.5" scale="1 1 1"></a-entity>
        -->
        <a-entity id="jukebox" position="0 0 -3.5">
          <a-box position="0 0.8 0" width="0.8" height="1.5" depth="0.5" color="#8B4513"
                 material="metalness: 0.3; roughness: 0.6"></a-box>
          <a-box position="0 1.4 0.1" width="0.6" height="0.5" depth="0.1" color="#222"
                 material="metalness: 0.8; roughness: 0.2"></a-box>
          <!-- Lumi√®res du jukebox -->
          <a-light type="point" intensity="0.5" distance="2" color="#FF6347" position="0 1.5 0.3"
                   animation__juke="property: color; from: #FF6347; to: #00CED1; dur: 2000; dir: alternate; loop: true"></a-light>
        </a-entity>

        <!-- BAR (fond) -->
        <a-entity id="bar" position="0 0 3.5">
          <a-box position="0 0.55 0" width="4" height="1.1" depth="0.5" color="#4a3728"
                 material="metalness: 0.2; roughness: 0.7"></a-box>
          <!-- Comptoir -->
          <a-box position="0 1.15 0" width="4.2" height="0.08" depth="0.6" color="#2a1a0a"
                 material="metalness: 0.4; roughness: 0.5"></a-box>
          <!-- Tabourets -->
          <a-entity position="-1.2 0 -0.6">
            <a-cylinder radius="0.15" height="0.05" position="0 0.7 0" color="#8B0000"></a-cylinder>
            <a-cylinder radius="0.03" height="0.65" position="0 0.35 0" color="#888"></a-cylinder>
          </a-entity>
          <a-entity position="0 0 -0.6">
            <a-cylinder radius="0.15" height="0.05" position="0 0.7 0" color="#8B0000"></a-cylinder>
            <a-cylinder radius="0.03" height="0.65" position="0 0.35 0" color="#888"></a-cylinder>
          </a-entity>
          <a-entity position="1.2 0 -0.6">
            <a-cylinder radius="0.15" height="0.05" position="0 0.7 0" color="#8B0000"></a-cylinder>
            <a-cylinder radius="0.03" height="0.65" position="0 0.35 0" color="#888"></a-cylinder>
          </a-entity>
        </a-entity>

        <!-- N√âONS D√âCORATIFS -->
        <a-entity position="0 4.5 -3.8">
          <a-text value="JACK RABBIT SLIM'S" align="center" color="#FF1493" 
                  scale="0.6 0.6 0.6" font="mozillavr">
          </a-text>
          <a-light type="point" intensity="1" distance="4" color="#FF1493" position="0 0 0.1"></a-light>
        </a-entity>

        <a-entity position="-3.8 3 0" rotation="0 90 0">
          <a-text value="‚ô™ TWIST CONTEST ‚ô™" align="center" color="#00CED1" 
                  scale="0.3 0.3 0.3"
                  animation__pulse="property: material.opacity; from: 0.7; to: 1; dur: 500; dir: alternate; loop: true">
          </a-text>
          <a-light type="point" intensity="0.6" distance="3" color="#00CED1"></a-light>
        </a-entity>

        <a-entity position="3.8 3 0" rotation="0 -90 0">
          <a-text value="‚òÖ SINCE 1950 ‚òÖ" align="center" color="#FFD700" 
                  scale="0.3 0.3 0.3"
                  animation__pulse="property: material.opacity; from: 0.7; to: 1; dur: 600; dir: alternate; loop: true">
          </a-text>
          <a-light type="point" intensity="0.6" distance="3" color="#FFD700"></a-light>
        </a-entity>

        <!-- √âCLAIRAGE AMBIANCE DINER -->
        <a-light type="ambient" color="#331111" intensity="0.3"></a-light>
        
        <!-- Spot principal dancefloor -->
        <a-light type="spot" position="0 5.8 -1" rotation="-90 0 0" 
                 intensity="2" color="#FFFAF0" angle="40" penumbra="0.4">
        </a-light>
        
        <!-- Spots color√©s -->
        <a-light type="point" position="-2 4 -2" intensity="0.7" color="#FF1493" distance="5"
                 animation__c1="property: intensity; from: 0.5; to: 0.9; dur: 1500; dir: alternate; loop: true"></a-light>
        <a-light type="point" position="2 4 -2" intensity="0.7" color="#00CED1" distance="5"
                 animation__c2="property: intensity; from: 0.9; to: 0.5; dur: 1500; dir: alternate; loop: true"></a-light>
        <a-light type="point" position="0 4 2" intensity="0.5" color="#FFD700" distance="4"></a-light>

      </a-entity>

      <!-- ========== SC√àNE B : LA MALLETTE ========== -->
      <a-entity id="scene-b" visible="false">
        
        <!-- 
        REMPLACEZ PAR UN MOD√àLE POLY PIZZA:
        <a-entity gltf-model="#briefcase-model" position="0 0.6 -1.5" scale="2 2 2"></a-entity>
        -->
        
        <a-entity id="briefcase" position="0 0.6 -1.5">
          <a-box id="briefcase-bottom" width="0.8" height="0.12" depth="0.5" color="#1a1a1a"
                 material="metalness: 0.8; roughness: 0.2">
            <a-box position="-0.28 0.07 0.26" width="0.06" height="0.015" depth="0.015" color="#D4AF37"
                   material="metalness: 1; roughness: 0.1"></a-box>
            <a-box position="0.28 0.07 0.26" width="0.06" height="0.015" depth="0.015" color="#D4AF37"
                   material="metalness: 1; roughness: 0.1"></a-box>
            <a-text value="CC" position="0 0.065 0.251" align="center"
                    color="#D4AF37" scale="0.08 0.08 0.08"></a-text>
          </a-box>
          
          <a-entity id="briefcase-hinge" position="0 0.06 -0.25" rotation="-115 0 0">
            <a-box id="briefcase-lid" 
                   width="0.8" height="0.05" depth="0.5" 
                   position="0 0 0.25" 
                   color="#1a1a1a"
                   material="metalness: 0.8; roughness: 0.2">
            </a-box>
          </a-entity>
          
          <a-box id="golden-interior" width="0.7" height="0.01" depth="0.4" position="0 0.065 0" 
                 material="color: #FFD700; shader: flat; emissive: #FFD700; emissiveIntensity: 8"></a-box>
          
          <a-light id="golden-light" type="point" intensity="10" color="#FFD700" position="0 0.5 0" distance="15"
                   animation__pulse="property: intensity; from: 8; to: 14; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine">
          </a-light>
          <a-light type="point" intensity="3" color="#FFA500" position="0 0.2 0" distance="6"></a-light>
        </a-entity>

        <a-text id="mystery-text" value="What's in the box?" position="0 3 -2" align="center" 
                color="#FFD700" scale="0.6 0.6 0.6" opacity="0">
        </a-text>

        <a-light type="ambient" color="#111" intensity="0.1"></a-light>
        
      </a-entity>

    </a-scene>

    <script>
      function updateDebug(msg) {
        const d = document.getElementById('debug');
        if (d) {
          d.innerHTML += `<br>${msg}`;
          d.scrollTop = d.scrollHeight;
        }
        console.log(msg);
      }

      document.addEventListener('DOMContentLoaded', () => {
        updateDebug('üé¨ Chanel x Pulp Fiction');
        updateDebug('‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ');
        
        const scene = document.querySelector('a-scene');
        
        scene.addEventListener('loaded', () => {
          updateDebug('‚úÖ Sc√®ne charg√©e');
          updateDebug('üéÆ ZQSD/Fl√®ches activ√©s');
          
          const milkshake = document.querySelector('#trigger-milkshake');
          const blackOut = document.querySelector('#black-out');
          const sceneA = document.querySelector('#scene-a');
          const sceneB = document.querySelector('#scene-b');
          const room = document.querySelector('#room');
          const floor = document.querySelector('#floor');
          const cursor = document.querySelector('#cursor');
          const instructions = document.getElementById('instructions');
          const controls = document.getElementById('controls');
          const mysteryText = document.querySelector('#mystery-text');

          let transitionDone = false;

          cursor.addEventListener('click', (evt) => {
            if (transitionDone) return;
            
            const intersectedEl = evt.detail.intersectedEl;
            if (intersectedEl) {
              let el = intersectedEl;
              while (el && el.id !== 'trigger-milkshake') {
                el = el.parentElement;
              }
              if (el && el.id === 'trigger-milkshake') {
                updateDebug('ü•§ $5 Shake cliqu√© !');
                transitionToSceneB();
              }
            }
          });

          milkshake.addEventListener('click', () => {
            if (transitionDone) return;
            updateDebug('ü•§ Shake (direct)');
            transitionToSceneB();
          });

          function transitionToSceneB() {
            if (transitionDone) return;
            transitionDone = true;
            
            updateDebug('‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ');
            updateDebug('üéûÔ∏è CUT !');

            if (instructions) instructions.innerHTML = 'THE MYSTERY';
            if (controls) controls.style.display = 'none';

            milkshake.classList.remove('clickable');

            blackOut.setAttribute('visible', 'true');
            blackOut.setAttribute('animation__fadeIn', {
              property: 'material.opacity',
              from: 0,
              to: 1,
              dur: 200,
              easing: 'easeInQuad'
            });

            setTimeout(() => {
              updateDebug('üîÑ Changement de sc√®ne');
              
              sceneA.setAttribute('visible', 'false');
              sceneB.setAttribute('visible', 'true');
              
              room.setAttribute('material', {
                color: '#050505',
                metalness: 0.95,
                roughness: 0.05,
                side: 'back'
              });

              floor.setAttribute('material', {
                color: '#030303',
                metalness: 0.9,
                roughness: 0.1
              });

              // Repositionner le joueur
              const rig = document.querySelector('#rig');
              rig.setAttribute('position', '0 0 1.5');

              setTimeout(() => {
                blackOut.setAttribute('animation__fadeOut', {
                  property: 'material.opacity',
                  from: 1,
                  to: 0,
                  dur: 1500,
                  easing: 'easeOutCubic'
                });

                setTimeout(() => {
                  mysteryText.setAttribute('animation__appear', {
                    property: 'opacity',
                    from: 0,
                    to: 0.9,
                    dur: 2000,
                    easing: 'easeOutQuad'
                  });
                }, 800);

                setTimeout(() => {
                  blackOut.setAttribute('visible', 'false');
                  updateDebug('‚úÖ R√©v√©lation');
                  updateDebug('üíº La Mallette...');
                  
                  setTimeout(() => {
                    if (instructions) instructions.style.opacity = '0';
                  }, 3000);
                  
                }, 1600);
                
              }, 150);

            }, 250);
          }

          updateDebug('‚úÖ Pr√™t');
          updateDebug('üëÜ Approchez du shake');
        });
      });
    </script>
  </body>
</html>